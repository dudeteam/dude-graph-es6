!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.dudeGraph=t.dudeGraph||{})}(this,function(t){"use strict";function e(t,e){for(var n=-1,o=t.length,r=Array(o);++n<o;)r[n]=e(t[n],n,t);return r}function n(t,e,n){for(var o=t.length,r=e+(n?0:-1);n?r--:++r<o;){var i=t[r];if(i!==i)return r}return-1}function o(t,e,o){if(e!==e)return n(t,o);for(var r=o-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function r(t,e,n,o){for(var r=n-1,i=t.length;++r<i;)if(o(t[r],e))return r;return-1}function i(t){return function(e){return t(e)}}function a(t,n,a,u){var c=u?r:o,l=-1,f=n.length,s=t;for(a&&(s=e(t,i(a)));++l<f;)for(var h=0,p=n[l],y=a?a(p):p;(h=c(s,y,h,u))>-1;)s!==t&&de.call(s,h,1),de.call(t,h,1);return t}function u(t,e){return t&&t.length&&e&&e.length?a(t,e):t}function c(t,e,n){var o=n.length;switch(o){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function l(t){var e="undefined"==typeof t?"undefined":ve["typeof"](t);return!!t&&("object"==e||"function"==e)}function f(t){var e=l(t)?we.call(t):"";return e==be||e==Ne}function s(t){return!!t&&"object"==("undefined"==typeof t?"undefined":ve["typeof"](t))}function h(t){return"symbol"==("undefined"==typeof t?"undefined":ve["typeof"](t))||s(t)&&Ee.call(t)==ge}function p(t){if("number"==typeof t)return t;if(h(t))return Ce;if(l(t)){var e=f(t.valueOf)?t.valueOf():t;t=l(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Oe,"");var n=je.test(t);return n||Ve.test(t)?Se(t.slice(2),n?2:8):Te.test(t)?Ce:+t}function y(t){if(!t)return 0===t?t:0;if(t=p(t),t===Be||t===-Be){var e=0>t?-1:1;return e*Pe}return t===t?t:0}function v(t){var e=y(t),n=e%1;return e===e?n?e-n:e:0}function m(t,e){if("function"!=typeof t)throw new TypeError(Ie);return e=Ae(void 0===e?t.length-1:v(e),0),function(){for(var n=arguments,o=-1,r=Ae(n.length-e,0),i=Array(r);++o<r;)i[o]=n[e+o];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,n[0],i);case 2:return t.call(this,n[0],n[1],i)}var a=Array(e+1);for(o=-1;++o<e;)a[o]=n[o];return a[e]=i,c(t,this,a)}}function d(t){return function(e,n,o){for(var r=-1,i=Object(e),a=o(e),u=a.length;u--;){var c=a[t?u:++r];if(n(i[c],c,i)===!1)break}return e}}function b(t){return Re(Object(t))}function N(t,e){return Ue.call(t,e)||"object"==("undefined"==typeof t?"undefined":ve["typeof"](t))&&e in t&&null===b(t)}function k(t){return Me(Object(t))}function w(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}function g(t){return function(e){return null==e?void 0:e[t]}}function _(t){return"number"==typeof t&&t>-1&&t%1==0&&De>=t}function E(t){return null!=t&&_($e(t))&&!f(t)}function C(t){return s(t)&&E(t)}function O(t){return C(t)&&We.call(t,"callee")&&(!He.call(t,"callee")||qe.call(t)==Fe)}function T(t){return"string"==typeof t||!Je(t)&&s(t)&&Xe.call(t)==Ke}function j(t){var e=t?t.length:void 0;return _(e)&&(Je(t)||T(t)||O(t))?w(e,String):null}function V(t,e){return e=null==e?Ye:e,!!e&&("number"==typeof t||Ze.test(t))&&t>-1&&t%1==0&&e>t}function S(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||tn;return t===n}function B(t){var e=S(t);if(!e&&!E(t))return k(t);var n=j(t),o=!!n,r=n||[],i=r.length;for(var a in t)!N(t,a)||o&&("length"==a||V(a,i))||e&&"constructor"==a||r.push(a);return r}function P(t,e){return t&&Le(t,e,B)}function I(t,e){return function(n,o){if(null==n)return n;if(!E(n))return t(n,o);for(var r=n.length,i=e?r:-1,a=Object(n);(e?i--:++i<r)&&o(a[i],i,a)!==!1;);return n}}function A(t,e,n,o){var r;return n(t,function(t,n,i){return e(t,n,i)?(r=o?n:t,!1):void 0}),r}function G(t,e,n){for(var o=t.length,r=n?o:-1;n?r--:++r<o;)if(e(t[r],r,t))return r;return-1}function L(){this.__data__=[]}function R(t,e){return t===e||t!==t&&e!==e}function x(t,e){for(var n=t.length;n--;)if(R(t[n][0],e))return n;return-1}function U(t){var e=this.__data__,n=x(e,t);if(0>n)return!1;var o=e.length-1;return n==o?e.pop():on.call(e,n,1),!0}function M(t){var e=this.__data__,n=x(e,t);return 0>n?void 0:e[n][1]}function $(t){return x(this.__data__,t)>-1}function D(t,e){var n=this.__data__,o=x(n,t);return 0>o?n.push([t,e]):n[o][1]=e,this}function F(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function z(){this.__data__=new F}function W(t){return this.__data__["delete"](t)}function q(t){return this.__data__.get(t)}function H(t){return this.__data__.has(t)}function J(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function K(t){if(null!=t){try{return rn.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Q(t){if(!l(t))return!1;var e=f(t)||J(t)?sn:un;return e.test(K(t))}function X(t,e){var n=t[e];return Q(n)?n:void 0}function Y(){this.__data__=hn?hn(null):{}}function Z(t){return this.has(t)&&delete this.__data__[t]}function tt(t){var e=this.__data__;if(hn){var n=e[t];return n===pn?void 0:n}return vn.call(e,t)?e[t]:void 0}function et(t){var e=this.__data__;return hn?void 0!==e[t]:dn.call(e,t)}function nt(t,e){var n=this.__data__;return n[t]=hn&&void 0===e?bn:e,this}function ot(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function rt(t){return t&&t.Object===Object?t:null}function it(){this.__data__={hash:new ot,map:new(Tn||F),string:new ot}}function at(t){var e="undefined"==typeof t?"undefined":ve["typeof"](t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function ut(t,e){var n=t.__data__;return at(e)?n["string"==typeof e?"string":"hash"]:n.map}function ct(t){return ut(this,t)["delete"](t)}function lt(t){return ut(this,t).get(t)}function ft(t){return ut(this,t).has(t)}function st(t,e){return ut(this,t).set(t,e),this}function ht(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function pt(t,e){var n=this.__data__;return n instanceof F&&n.__data__.length==jn&&(n=this.__data__=new ht(n.__data__)),n.set(t,e),this}function yt(t){this.__data__=new F(t)}function vt(t){return this.__data__.set(t,Vn),this}function mt(t){return this.__data__.has(t)}function dt(t){var e=-1,n=t?t.length:0;for(this.__data__=new ht;++e<n;)this.add(t[e])}function bt(t,e){for(var n=-1,o=t.length;++n<o;)if(e(t[n],n,t))return!0;return!1}function Nt(t,e,n,o,r,i){var a=r&Bn,u=t.length,c=e.length;if(u!=c&&!(a&&c>u))return!1;var l=i.get(t);if(l)return l==e;var f=-1,s=!0,h=r&Sn?new dt:void 0;for(i.set(t,e);++f<u;){var p=t[f],y=e[f];if(o)var v=a?o(y,p,f,e,t,i):o(p,y,f,t,e,i);if(void 0!==v){if(v)continue;s=!1;break}if(h){if(!bt(e,function(t,e){return h.has(e)||p!==t&&!n(p,t,o,r,i)?void 0:h.add(e)})){s=!1;break}}else if(p!==y&&!n(p,y,o,r,i)){s=!1;break}}return i["delete"](t),s}function kt(t){var e=-1,n=Array(t.size);return t.forEach(function(t,o){n[++e]=[o,t]}),n}function wt(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function gt(t,e,n,o,r,i,a){switch(n){case qn:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Wn:return!(t.byteLength!=e.byteLength||!o(new In(t),new In(e)));case Ln:case Rn:return+t==+e;case xn:return t.name==e.name&&t.message==e.message;case Mn:return t!=+t?e!=+e:t==+e;case $n:case Fn:return t==e+"";case Un:var u=kt;case Dn:var c=i&Gn;if(u||(u=wt),t.size!=e.size&&!c)return!1;var l=a.get(t);return l?l==e:(i|=An,a.set(t,e),Nt(u(t),u(e),o,r,i,a));case zn:if(Jn)return Jn.call(t)==Jn.call(e)}return!1}function _t(t,e,n,o,r,i){var a=r&Kn,u=B(t),c=u.length,l=B(e),f=l.length;if(c!=f&&!a)return!1;for(var s=c;s--;){var h=u[s];if(!(a?h in e:N(e,h)))return!1}var p=i.get(t);if(p)return p==e;var y=!0;i.set(t,e);for(var v=a;++s<c;){h=u[s];var m=t[h],d=e[h];if(o)var b=a?o(d,m,h,e,t,i):o(m,d,h,t,e,i);if(!(void 0===b?m===d||n(m,d,o,r,i):b)){y=!1;break}v||(v="constructor"==h)}if(y&&!v){var k=t.constructor,w=e.constructor;k!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof k&&k instanceof k&&"function"==typeof w&&w instanceof w)&&(y=!1)}return i["delete"](t),y}function Et(t){return uo.call(t)}function Ct(t){return s(t)&&_(t.length)&&!!Uo[$o.call(t)]}function Ot(t,e,n,o,r,i){var a=Je(t),u=Je(e),c=zo,l=zo;a||(c=po(t),c=c==Fo?Wo:c),u||(l=po(e),l=l==Fo?Wo:l);var f=c==Wo&&!J(t),s=l==Wo&&!J(e),h=c==l;if(h&&!f)return i||(i=new yt),a||Ct(t)?Nt(t,e,n,o,r,i):gt(t,e,c,n,o,r,i);if(!(r&Do)){var p=f&&Ho.call(t,"__wrapped__"),y=s&&Ho.call(e,"__wrapped__");if(p||y){var v=p?t.value():t,m=y?e.value():e;return i||(i=new yt),n(v,m,o,r,i)}}return h?(i||(i=new yt),_t(t,e,n,o,r,i)):!1}function Tt(t,e,n,o,r){return t===e?!0:null==t||null==e||!l(t)&&!s(e)?t!==t&&e!==e:Ot(t,e,Tt,n,o,r)}function jt(t,e,n,o){var r=n.length,i=r,a=!o;if(null==t)return!i;for(t=Object(t);r--;){var u=n[r];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++r<i;){u=n[r];var c=u[0],l=t[c],f=u[1];if(a&&u[2]){if(void 0===l&&!(c in t))return!1}else{var s=new yt;if(o)var h=o(l,f,c,t,e,s);if(!(void 0===h?Tt(f,l,o,Jo|Ko,s):h))return!1}}return!0}function Vt(t){return t===t&&!l(t)}function St(t,n){return e(n,function(e){return[e,t[e]]})}function Bt(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function Pt(t){return function(e){var n=po(e);return n==Qo?kt(e):n==Xo?Bt(e):St(e,t(e))}}function It(t){for(var e=Yo(t),n=e.length;n--;)e[n][2]=Vt(e[n][1]);return e}function At(t,e){return function(n){return null==n?!1:n[t]===e&&(void 0!==e||t in Object(n))}}function Gt(t){var e=It(t);return 1==e.length&&e[0][2]?At(e[0][0],e[0][1]):function(n){return n===t||jt(n,t,e)}}function Lt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(Zo);var n=function o(){var n=arguments,r=e?e.apply(this,n):n[0],i=o.cache;if(i.has(r))return i.get(r);var a=t.apply(this,n);return o.cache=i.set(r,a),a};return n.cache=new(Lt.Cache||ht),n}function Rt(t){if("string"==typeof t)return t;if(h(t))return nr?nr.call(t):"";var e=t+"";return"0"==e&&1/t==-tr?"-0":e}function xt(t){return null==t?"":Rt(t)}function Ut(t){return Je(t)?t:ir(t)}function Mt(t,e){if(Je(t))return!1;var n="undefined"==typeof t?"undefined":ve["typeof"](t);return"number"==n||"symbol"==n||"boolean"==n||null==t||h(t)?!0:ur.test(t)||!ar.test(t)||null!=e&&t in Object(e)}function $t(t){if("string"==typeof t||h(t))return t;var e=t+"";return"0"==e&&1/t==-cr?"-0":e}function Dt(t,e){e=Mt(e,t)?[e]:Ut(e);for(var n=0,o=e.length;null!=t&&o>n;)t=t[$t(e[n++])];return n&&n==o?t:void 0}function Ft(t,e,n){var o=null==t?void 0:Dt(t,e);return void 0===o?n:o}function zt(t,e){return e in Object(t)}function Wt(t,e,n){e=Mt(e,t)?[e]:Ut(e);for(var o,r=-1,i=e.length;++r<i;){var a=$t(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}if(o)return o;var i=t?t.length:0;return!!i&&_(i)&&V(a,i)&&(Je(t)||T(t)||O(t))}function qt(t,e){return null!=t&&Wt(t,e,zt)}function Ht(t,e){return Mt(t)&&Vt(e)?At($t(t),e):function(n){var o=Ft(n,t);return void 0===o&&o===e?qt(n,t):Tt(e,o,void 0,lr|fr)}}function Jt(t){return t}function Kt(t){return function(e){return Dt(e,t)}}function Qt(t){return Mt(t)?g($t(t)):Kt(t)}function Xt(t){return"function"==typeof t?t:null==t?Jt:"object"==("undefined"==typeof t?"undefined":ve["typeof"](t))?Je(t)?Ht(t[0],t[1]):Gt(t):Qt(t)}function Yt(t,e){if(e=Xt(e,3),Je(t)){var n=G(t,e);return n>-1?t[n]:void 0}return A(t,e,en)}function Zt(t,e){for(var n=-1,o=t.length,r=0,i=[];++n<o;){var a=t[n];e(a,n,t)&&(i[r++]=a)}return i}function te(t,e){var n=[];return en(t,function(t,o,r){e(t,o,r)&&n.push(t)}),n}function ee(t,e){var n=Je(t)?Zt:te;return n(t,Xt(e,3))}function ne(t,e){return t&&P(t,Xt(e,3))}function oe(t,n){return e(n,function(e){return t[e]})}function re(t){return t?oe(t,B(t)):[]}function ie(t,e,n,r){t=E(t)?t:re(t),n=n&&!r?v(n):0;var i=t.length;return 0>n&&(n=sr(i+n,0)),T(t)?i>=n&&t.indexOf(e,n)>-1:!!i&&o(t,e,n)>-1}function ae(t){return"number"==typeof t||s(t)&&mr.call(t)==yr}function ue(t){return t===!0||t===!1||s(t)&&Nr.call(t)==dr}function ce(t,e){for(var n=-1,o=t.length;++n<o&&e(t[n],n,t)!==!1;);return t}function le(t,e){var n=Je(t)?ce:en;return n(t,Xt(e,3))}function fe(t,e){var n=-1,o=E(t)?Array(t.length):[];return en(t,function(t,r,i){o[++n]=e(t,r,i)}),o}function se(t,n){var o=Je(t)?e:fe;return o(t,Xt(n,3))}function he(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function pe(t,e){return t&&Ar(t,e,B)}function ye(t,e){var n=Je(t)?he:Gr;return n(t,Xt(e,3))}var ve={};ve["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},ve.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},ve.createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),ve.inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},ve.possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e};var me=Array.prototype,de=me.splice,be="[object Function]",Ne="[object GeneratorFunction]",ke=Object.prototype,we=ke.toString,ge="[object Symbol]",_e=Object.prototype,Ee=_e.toString,Ce=NaN,Oe=/^\s+|\s+$/g,Te=/^[-+]0x[0-9a-f]+$/i,je=/^0b[01]+$/i,Ve=/^0o[0-7]+$/i,Se=parseInt,Be=1/0,Pe=1.7976931348623157e308,Ie="Expected a function",Ae=Math.max,Ge=m(u),Le=d(),Re=Object.getPrototypeOf,xe=Object.prototype,Ue=xe.hasOwnProperty,Me=Object.keys,$e=g("length"),De=9007199254740991,Fe="[object Arguments]",ze=Object.prototype,We=ze.hasOwnProperty,qe=ze.toString,He=ze.propertyIsEnumerable,Je=Array.isArray,Ke="[object String]",Qe=Object.prototype,Xe=Qe.toString,Ye=9007199254740991,Ze=/^(?:0|[1-9]\d*)$/,tn=Object.prototype,en=I(P),nn=Array.prototype,on=nn.splice;F.prototype.clear=L,F.prototype["delete"]=U,F.prototype.get=M,F.prototype.has=$,F.prototype.set=D;var rn=Function.prototype.toString,an=/[\\^$.*+?()[\]{}|]/g,un=/^\[object .+?Constructor\]$/,cn=Object.prototype,ln=Function.prototype.toString,fn=cn.hasOwnProperty,sn=RegExp("^"+ln.call(fn).replace(an,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hn=X(Object,"create"),pn="__lodash_hash_undefined__",yn=Object.prototype,vn=yn.hasOwnProperty,mn=Object.prototype,dn=mn.hasOwnProperty,bn="__lodash_hash_undefined__";ot.prototype.clear=Y,ot.prototype["delete"]=Z,ot.prototype.get=tt,ot.prototype.has=et,ot.prototype.set=nt;var Nn={"function":!0,object:!0},kn=Nn["undefined"==typeof t?"undefined":ve["typeof"](t)]&&t&&!t.nodeType?t:void 0,wn=Nn["undefined"==typeof module?"undefined":ve["typeof"](module)]&&module&&!module.nodeType?module:void 0,gn=rt(kn&&wn&&"object"==("undefined"==typeof global?"undefined":ve["typeof"](global))&&global),_n=rt(Nn["undefined"==typeof self?"undefined":ve["typeof"](self)]&&self),En=rt(Nn["undefined"==typeof window?"undefined":ve["typeof"](window)]&&window),Cn=rt(Nn[ve["typeof"](this)]&&this),On=gn||En!==(Cn&&Cn.window)&&En||_n||Cn||Function("return this")(),Tn=X(On,"Map");ht.prototype.clear=it,ht.prototype["delete"]=ct,ht.prototype.get=lt,ht.prototype.has=ft,ht.prototype.set=st;var jn=200;yt.prototype.clear=z,yt.prototype["delete"]=W,yt.prototype.get=q,yt.prototype.has=H,yt.prototype.set=pt;var Vn="__lodash_hash_undefined__";dt.prototype.add=dt.prototype.push=vt,dt.prototype.has=mt;var Sn=1,Bn=2,Pn=On.Symbol,In=On.Uint8Array,An=1,Gn=2,Ln="[object Boolean]",Rn="[object Date]",xn="[object Error]",Un="[object Map]",Mn="[object Number]",$n="[object RegExp]",Dn="[object Set]",Fn="[object String]",zn="[object Symbol]",Wn="[object ArrayBuffer]",qn="[object DataView]",Hn=Pn?Pn.prototype:void 0,Jn=Hn?Hn.valueOf:void 0,Kn=2,Qn=X(On,"DataView"),Xn=X(On,"Promise"),Yn=X(On,"Set"),Zn=X(On,"WeakMap"),to="[object Map]",eo="[object Object]",no="[object Promise]",oo="[object Set]",ro="[object WeakMap]",io="[object DataView]",ao=Object.prototype,uo=ao.toString,co=K(Qn),lo=K(Tn),fo=K(Xn),so=K(Yn),ho=K(Zn);(Qn&&Et(new Qn(new ArrayBuffer(1)))!=io||Tn&&Et(new Tn)!=to||Xn&&Et(Xn.resolve())!=no||Yn&&Et(new Yn)!=oo||Zn&&Et(new Zn)!=ro)&&(Et=function(t){var e=uo.call(t),n=e==eo?t.constructor:void 0,o=n?K(n):void 0;if(o)switch(o){case co:return io;case lo:return to;case fo:return no;case so:return oo;case ho:return ro}return e});var po=Et,yo="[object Arguments]",vo="[object Array]",mo="[object Boolean]",bo="[object Date]",No="[object Error]",ko="[object Function]",wo="[object Map]",go="[object Number]",_o="[object Object]",Eo="[object RegExp]",Co="[object Set]",Oo="[object String]",To="[object WeakMap]",jo="[object ArrayBuffer]",Vo="[object DataView]",So="[object Float32Array]",Bo="[object Float64Array]",Po="[object Int8Array]",Io="[object Int16Array]",Ao="[object Int32Array]",Go="[object Uint8Array]",Lo="[object Uint8ClampedArray]",Ro="[object Uint16Array]",xo="[object Uint32Array]",Uo={};Uo[So]=Uo[Bo]=Uo[Po]=Uo[Io]=Uo[Ao]=Uo[Go]=Uo[Lo]=Uo[Ro]=Uo[xo]=!0,Uo[yo]=Uo[vo]=Uo[jo]=Uo[mo]=Uo[Vo]=Uo[bo]=Uo[No]=Uo[ko]=Uo[wo]=Uo[go]=Uo[_o]=Uo[Eo]=Uo[Co]=Uo[Oo]=Uo[To]=!1;var Mo=Object.prototype,$o=Mo.toString,Do=2,Fo="[object Arguments]",zo="[object Array]",Wo="[object Object]",qo=Object.prototype,Ho=qo.hasOwnProperty,Jo=1,Ko=2,Qo="[object Map]",Xo="[object Set]",Yo=Pt(B),Zo="Expected a function";Lt.Cache=ht;var tr=1/0,er=Pn?Pn.prototype:void 0,nr=er?er.toString:void 0,or=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,rr=/\\(\\)?/g,ir=Lt(function(t){var e=[];return xt(t).replace(or,function(t,n,o,r){e.push(o?r.replace(rr,"$1"):n||t)}),e}),ar=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ur=/^\w*$/,cr=1/0,lr=1,fr=2,sr=Math.max,hr=Symbol("listeners"),pr=function(){function t(){ve.classCallCheck(this,t),this[hr]={}}return ve.createClass(t,[{key:"on",value:function(t,e){return"undefined"==typeof this[hr][t]&&(this[hr][t]=[]),this[hr][t].push(e),e}},{key:"once",value:function(t,e){var n=this,o=function r(){e(),n.off(t,r)};this.on(t,o)}},{key:"off",value:function(t,e){if("undefined"!=typeof this[hr][t])if("undefined"==typeof e)this[hr][t]=[];else{var n=this[hr][t].lastIndexOf(e);-1!==n&&this[hr][t].splice(n,1)}}},{key:"emit",value:function(t){var e=this[hr][t];if("undefined"!=typeof e)for(var n=0;n<e.length;n++)e[n].apply(this,Array.prototype.slice.call(arguments,1))}}]),t}(),yr="[object Number]",vr=Object.prototype,mr=vr.toString,dr="[object Boolean]",br=Object.prototype,Nr=br.toString,kr={Stream:{convert:function(){},typeCompatibles:[]},String:{typeConvert:function(t){return T(t)?t:ae(t)||ue(t)?xt(t):void 0},typeCompatibles:["Text","Number","Boolean"]},Text:{typeConvert:function(t){return T(t)?t:ae(t)||ue(t)?xt(t):void 0},typeCompatibles:["String","Number","Boolean"]},Number:{typeConvert:function(t){return ae(t)?t:/^[-+]?[0-9]+(\.[0-9]+)?$/.test(t)?p(t):"true"===t||t===!0?1:"false"===t||t===!1?0:void 0},typeCompatibles:["Boolean"]},Boolean:{typeConvert:function(t){return ue(t)?t:1===t||"true"===t?!0:0===t||"false"===t?!1:void 0},typeCompatibles:["Number"]},Object:{typeConvert:function(t){return l(t)?t:void 0},typeCompatibles:[]},Array:{typeConvert:function(t){return Je(t)?t:void 0},typeCompatibles:[]},Resource:{typeConvert:function(t){return l(t)?t:void 0},typeCompatibles:[]}},wr=Symbol("outputPoint"),gr=Symbol("inputPoint"),_r=function(t){function e(t,n){ve.classCallCheck(this,e);var o=ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return o[wr]=t,o[gr]=n,o}return ve.inherits(e,t),ve.createClass(e,[{key:"other",value:function(t){if(t===this[wr])return this[gr];if(t===this[gr])return this[wr];throw new Error(this.fancyName)}},{key:"fancyName",get:function(){return this[wr].fancyName+" => "+this[gr].fancyName}},{key:"connectionOutputPoint",get:function(){return this[wr]}},{key:"connectionInputPoint",get:function(){return this[gr]}}]),e}(pr),Er={VALUE:1,SINGLE_CONNECTION:2,MULTIPLE_CONNECTIONS:4,CONVERSION:8},Cr=function(){function t(){ve.classCallCheck(this,t)}return ve.createClass(t,null,[{key:"serialize",value:function(t){var e=[];return ne(Er,function(n,o){0!==(n&t)&&e.push(o)}),e}},{key:"deserialize",value:function(t){var e=0;return le(t,function(t){var n=Er[t];if("undefined"==typeof n)throw new Error("`"+t+"` is not a valid point policy");e|=n}),e}},{key:"has",value:function(t,e){return 0!==(t&e)}},{key:"NONE",get:function(){return 0}},{key:"VALUE",get:function(){return Er.VALUE}},{key:"SINGLE_CONNECTION",get:function(){return Er.SINGLE_CONNECTION}},{key:"MULTIPLE_CONNECTIONS",get:function(){return Er.MULTIPLE_CONNECTIONS}},{key:"CONVERSION",get:function(){return Er.CONVERSION}},{key:"DEFAULT",get:function(){return t.VALUE|t.SINGLE_CONNECTION|t.CONVERSION}}]),t}(),Or=Symbol("graphErrno"),Tr=Symbol("graphBlocks"),jr=Symbol("graphBlockIds"),Vr=Symbol("graphVariables"),Sr=Symbol("graphValueTypes"),Br=Symbol("graphConnections"),Pr=function(t){function e(){ve.classCallCheck(this,e);var t=ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return t[Or]=null,t[Tr]=[],t[jr]={},t[Vr]=[],t[Sr]={},t[Br]=[],t.create(),t}return ve.inherits(e,t),ve.createClass(e,[{key:"create",value:function(){this[Sr]=kr}},{key:"addBlock",value:function(t){if(null!==t.blockGraph)throw new Error("`"+t.fancyName+"` cannot redefine `blockGraph`");if(null!==t.blockId&&"undefined"==typeof this[jr][t.blockId])throw new Error("`"+this.fancyName+"` cannot redefine id `"+t.blockId+"`");t.blockGraph=this,null===t.blockId&&(t.blockId=this.nextBlockId()),ne(t.blockTemplates,function(e,n){t.changeTemplate(n,e.valueType,!0)}),this[Tr].push(t),this[jr][t.blockId]=t,this.emit("block-add",t),t.added()}},{key:"removeBlock",value:function(t){if(t.blockGraph!==this||!ie(this[Tr],t))throw new Error("`"+this.fancyName+"` has no block `"+t.fancyName+"`");t.removePoints(),Ge(this[Tr],t),delete this[jr][t.blockId],this.emit("block-remove",t),t.removed()}},{key:"nextBlockId",value:function(){return 9999*Math.random()+this}},{key:"blockById",value:function(t){return this[jr][t]||null}},{key:"blocksByName",value:function(t){return ee(this[Tr],function(e){return e.blockName===t})}},{key:"blocksByType",value:function(t){return ee(this[Tr],function(e){return e.blockType===t||e instanceof t})}},{key:"addVariable",value:function(t){if(null!==t.variableGraph)throw new Error("`"+t.fancyName+"` cannot redefine `variableGraph`");if(null!==this.variableByName(t.variableName))throw new Error("`"+this.fancyName+"` cannot redefine variable name `"+t.variableName+"`");t.variableGraph=this,t.added(),this[Vr].push(t),this.emit("variable-add",t)}},{key:"removeVariable",value:function(t){if(t.variableGraph!==this||null===this.variableByName(t.variableName))throw new Error("`"+this.fancyName+"` has no variable `"+t.fancyName+"`");null!==t.variableBlock&&this.removeBlock(t.variableBlock),Ge(this[Vr],t),this.emit("variable-remove",t)}},{key:"variableByName",value:function(t){return Yt(this[Vr],function(e){return e.variableName===t})||null}},{key:"convertValue",value:function(t,e){if(null===e)return null;var n=this.valueTypeByName(t);if(null===n)throw new Error("`"+this.fancyName+"` has no valueType `"+t+"`");if("undefined"==typeof n.typeConvert)throw new Error("`"+this.fancyName+"` has no valueType `"+t+"` converter");return n.typeConvert(e)}},{key:"convertConnection",value:function(t,e){var n=this.valueTypeByName(e.pointValueType);if(null===n)throw new Error("`"+this.fancyName+"` cannot find compatible type to convert connection from `"+t.pointValueType+"` to `"+e.pointValueType+"`");if("undefined"!=typeof t.pointOutput&&!t.pointOutput)return this.errno(Error("`"+t.fancyName+"` is not an output")),!1;if("undefined"!=typeof e.pointOutput&&e.pointOutput)return this.errno(Error("`"+e.fancyName+"` is not an input")),!1;if("undefined"!=typeof t.pointValue&&null!==t.pointValue)return this.errno(new Error("`"+t.fancyName+"` have a non-null `pointValue` and cannot be connected")),!1;if("undefined"!=typeof e.pointValue&&null!==e.pointValue)return this.errno(new Error("`"+e.fancyName+"` have a non-null `pointValue` and cannot be connected")),!1;if("undefined"!=typeof t.hasPolicy&&t.hasPolicy(Cr.SINGLE_CONNECTION)&&!t.emptyConnection())return this.errno(new Error("`"+t.fancyName+"` cannot have multiple connections")),!1;if("undefined"!=typeof e.hasPolicy&&e.hasPolicy(Cr.SINGLE_CONNECTION)&&!e.emptyConnection())return this.errno(new Error("`"+e.fancyName+"` cannot have multiple connections")),!1;if("undefined"!=typeof t.hasPolicy&&!t.hasPolicy(Cr.SINGLE_CONNECTION)&&!t.hasPolicy(Cr.MULTIPLE_CONNECTIONS))return this.errno(new Error("`"+t.fancyName+"` cannot have connections")),!1;if("undefined"!=typeof e.hasPolicy&&!e.hasPolicy(Cr.SINGLE_CONNECTION)&&!e.hasPolicy(Cr.MULTIPLE_CONNECTIONS))return this.errno(new Error("`"+e.fancyName+"` cannot have connections")),!1;if(t.pointValueType===e.pointValueType)return!0;if("undefined"!=typeof t.hasPolicy&&!t.hasPolicy(Cr.CONVERSION))return this.errno(new Error("`"+t.fancyName+"` cannot be converted")),!1;if("undefined"!=typeof e.hasPolicy&&!e.hasPolicy(Cr.CONVERSION))return this.errno(new Error("`"+e.fancyName+"` cannot be converted")),!1;if(!ie(n.typeCompatibles,t.pointValueType))return this.errno(new Error("`"+e.pointValueType+"` is not compatible with `"+t.pointValueType+"`")),!1;var o=this[Or];return"undefined"==typeof t.acceptConnect||t.acceptConnect(e)?(o=this[Or],"undefined"==typeof e.acceptConnect||e.acceptConnect(t)?!0:(null!==this[Or]&&this[Or]!==o?this.errno(new Error("`"+t.fancyName+"` cannot accept to connect to `"+e.fancyName+"`: "+this[Or].message)):this.errno(new Error("`"+t.fancyName+"` cannot accept to connect to `"+e.fancyName+"`")),!1)):(null!==this[Or]&&this[Or]!==o?this.errno(new Error("`"+t.fancyName+"` cannot accept to connect to `"+e.fancyName+"`: "+this[Or].message)):this.errno(new Error("`"+t.fancyName+"` cannot accept to connect to `"+e.fancyName+"`")),!1)}},{key:"connect",value:function(t,e){if(null===t.pointBlock)throw new Error("`"+t.fancyName+"` cannot connect to another point when not bound to a block");if(null===e.pointBlock)throw new Error("`"+e.fancyName+"` cannot connect to another point when not bound to a block");if(t===e)throw new Error("`"+this.fancyName+"` cannot connect `"+t.fancyName+"` to itself");if(!t.pointOutput)throw new Error("`"+t.fancyName+"` is not an output");if(e.pointOutput)throw new Error("`"+t.fancyName+"` is not an input");if(!this.convertConnection(t,e)){var n=this[Or]||{};if(null===t.pointTemplate&&null===e.pointTemplate)throw new Error("`"+this.fancyName+"` cannot connect `"+t.fancyName+"` to `"+e.fancyName+": "+n.message);try{t.pointBlock.changeTemplate(t.pointTemplate,e.pointValueType)}catch(o){null!==e.pointTemplate&&e.pointBlock.changeTemplate(e.pointTemplate,t.pointValueType)}}var r=Yt(this[Br],function(n){return n.connectionOutputPoint===t&&n.connectionInputPoint===e})||null;if(null!==r)throw new Error("`"+r.fancyName+"` already exists");var i=new _r(t,e);if(!t.pointBlock.acceptConnect(t,e))throw new Error(this[Or]);if(!e.pointBlock.acceptConnect(e,t))throw new Error(this[Or]);return this._addConnection(i),t.pointBlock.pointConnected(t,e),e.pointBlock.pointConnected(e,t),t.emit("connect",i),e.emit("connect",i),this.emit("point-connect",t,i),this.emit("point-connect",e,i),i}},{key:"disconnect",value:function(t,e){if(null===t.pointBlock)throw new Error("`"+t.fancyName+"` cannot disconnect from another point when not bound to a block");if(null===e.pointBlock)throw new Error("`"+e.fancyName+"` cannot disconnect from another point when not bound to a block");var n=Yt(this[Br],function(n){return n.connectionOutputPoint===t&&n.connectionInputPoint===e})||null;if(null===n)throw new Error("`"+this.fancyName+"` cannot find a connection between `"+t.fancyName+"` and `"+e.fancyName+"`");return this._removeConnection(n),t.pointBlock.pointDisconnected(t,e),e.pointBlock.pointDisconnected(e,t),t.emit("disconnect",n),e.emit("disconnect",n),this.emit("point-disconnect",t,n),this.emit("point-disconnect",e,n),n}},{key:"_addConnection",value:function(t){var e=t.connectionOutputPoint,n=t.connectionInputPoint;if(ie(e.pointConnections,t))throw new Error("`"+e.fancyName+"` cannot redefine `"+t.fancyName+"`");if(ie(n.pointConnections,t))throw new Error("`"+n.fancyName+"` cannot redefine `"+t.fancyName+"`");e.pointConnections.push(t),n.pointConnections.push(t),this[Br].push(t)}},{key:"_removeConnection",value:function(t){var e=t.connectionOutputPoint,n=t.connectionInputPoint;if(!ie(e.pointConnections,t))throw new Error("`"+e.fancyName+"` has no connection `"+t.fancyName+"`");if(!ie(n.pointConnections,t))throw new Error("`"+n.fancyName+"` has no connection `"+t.fancyName+"`");Ge(t.connectionOutputPoint.pointConnections,t),Ge(t.connectionInputPoint.pointConnections,t),Ge(this[Br],t)}},{key:"addValueType",value:function(t){if(null!==this.valueTypeByName(t.typeName))throw new Error("`"+this.fancyName+"` cannot redefine value type`"+t.typeName+"`");this[Sr][t.typeName]=t}},{key:"valueTypeByName",value:function(t){return this[Sr][t]||null}},{key:"errno",value:function(t){this[Or]=t}},{key:"fancyName",get:function(){return"graph ("+this[Tr].length+" blocks)"}},{key:"graphBlocks",get:function(){return this[Tr]}},{key:"graphVariables",get:function(){return this[Vr]}},{key:"graphConnections",get:function(){return this[Br]}}]),e}(pr),Ir=function(t,e){return"undefined"==typeof t?e:t},Ar=d(!0),Gr=I(pe,!0),Lr=Symbol("blockId"),Rr=Symbol("blockName"),xr=Symbol("blockInputs"),Ur=Symbol("blockOutputs"),Mr=Symbol("blockTemplate"),$r=Symbol("blockGraph"),Dr=function(t){function e(t){ve.classCallCheck(this,e);var n=ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return n[Lr]=null,n[Rr]=null,n[Ur]=[],n[xr]=[],n[Mr]=null,n[$r]=null,n.create(t||{}),n}return ve.inherits(e,t),ve.createClass(e,[{key:"create",value:function(t){this[Lr]=Ir(t.blockId,null),this[Rr]=Ir(t.blockName,this.blockType),this[Mr]=Ir(t.blockTemplates,{})}},{key:"added",value:function(){}},{key:"pointAdded",value:function(){}},{key:"pointConnected",value:function(){}},{key:"pointValueChanged",value:function(){}},{key:"pointDisconnected",value:function(){}},{key:"pointRemoved",value:function(){}},{key:"removed",value:function(){}},{key:"validatePoints",value:function(){}},{key:"changeTemplate",value:function(t,e,n){if(null===this[$r])throw new Error("`"+this.fancyName+"` cannot manipulate templates when not bound to a graph");if(null===this[$r].valueTypeByName(e))throw new Error("`"+this.fancyName+"` has no value type `"+e+"`");var o=this.templateByName(t);if(null===o)throw new Error("`"+this.fancyName+"` has no template `"+t+"`");if(!ie(o.templates,e))throw new Error("`"+this.fancyName+"` has no value type `"+e+"` is its templates: ` "+o.templates.join(", ")+"`");if(o.valueType!==e){var r=o.valueType,i=se(this[Ur],function(e){return e.pointTemplate===t?e.pointValue:void 0}),a=se(this[xr],function(e){return e.pointTemplate===t?e.pointValue:void 0});try{le(this[Ur],function(o){o.pointTemplate===t&&o.changeValueType(e,n)}),le(this[xr],function(o){o.pointTemplate===t&&o.changeValueType(e,n)})}catch(u){throw le(this[Ur],function(e,n){e.pointTemplate===t&&(e.changeVariableValue(null),e.changeValueType(r,!0),e.changeVariableValue(i[n]))}),le(this[xr],function(e,n){e.pointTemplate===t&&(e.changeVariableValue(null),e.changeValueType(r,!0),e.changeVariableValue(a[n]))}),u}o.valueType=e,n||(this[$r].emit("block-template-update",this,t,o.valueType,r),this.emit("template-update",t,o.valueType,r))}}},{key:"templateByName",value:function(t){if(null===this[$r])throw new Error("`"+this.fancyName+"` cannot manipulate templates when not bound to a graph");
return this[Mr][t]||null}},{key:"addPoint",value:function(t,e){if(null===this[$r])throw new Error("`"+this.fancyName+"` cannot add point when not bound to a graph");if(t.pointOutput&&null!==this.outputByName(t.pointName))throw new Error("`"+this.fancyName+"` cannot redefine `"+t.pointName+"`");if(!t.pointOutput&&null!==this.inputByName(t.pointName))throw new Error("`"+this.fancyName+"` cannot redefine `"+t.pointName+"`");t.pointBlock=this;try{if(null===t.pointTemplate)t.changeValueType(t.pointValueType,!0);else{var n=this.templateByName(t.pointTemplate);if(null===n)throw new Error("`"+this.fancyName+"` has no template `"+t.pointTemplate+"`");t.changeValueType(n.valueType,!0)}t.changeValue(t.pointValue,!0)}catch(o){throw t.pointBlock=null,o}t.added(),"undefined"==typeof e&&(e=t.pointOutput?this[Ur].length:this[xr].length),t.pointOutput?this[Ur].splice(e,0,t):this[xr].splice(e,0,t),this.emit("point-add",t),this[$r].emit("block-point-add",this,t)}},{key:"removePoint",value:function(t){if(t.pointOutput&&null===this.outputByName(t.pointName))throw new Error("`"+this.fancyName+"` has not output `"+t.pointName+"`");if(!t.pointOutput&&null===this.inputByName(t.pointName))throw new Error("`"+this.fancyName+"` has no input `"+t.pointName+"`");t.disconnectAll(),t.removed(),t.pointBlock=null,t.pointOutput?Ge(this[Ur],t):Ge(this[xr],t),this.emit("point-remove",t),this[$r].emit("block-point-remove",this,t)}},{key:"removePoints",value:function(){var t=this;ye(this[Ur],function(e){t.removePoint(e)}),ye(this[xr],function(e){t.removePoint(e)})}},{key:"outputByName",value:function(t){return Yt(this[Ur],function(e){return e.pointName===t})||null}},{key:"inputByName",value:function(t){return Yt(this[xr],function(e){return e.pointName===t})||null}},{key:"acceptConnect",value:function(t,e){if(t.pointBlock!==this)throw new Error("`"+this.fancyName+"` has no `"+t.pointName+"`");return e===e}},{key:"fancyName",get:function(){return this[Rr]}},{key:"blockType",get:function(){return this.constructor.name}},{key:"blockId",get:function(){return this[Lr]},set:function(t){this[Lr]=t}},{key:"blockName",get:function(){return this[Rr]}},{key:"blockOutputs",get:function(){return this[Ur]}},{key:"blockInputs",get:function(){return this[xr]}},{key:"blockTemplates",get:function(){return this[Mr]}},{key:"blockGraph",get:function(){return this[$r]},set:function(t){this[$r]=t}}]),e}(pr),Fr=Symbol("_graphVariable"),zr=function(t){function e(t){ve.classCallCheck(this,e);var n=ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t));return n[Fr]=null,n}return ve.inherits(e,t),ve.createClass(e,[{key:"added",value:function(){if(this[Fr]=this.blockGraph.variableByName(this.blockName),null===this[Fr])throw this.blockGraph.removeBlock(this),new Error("VariableBlock `"+this.fancyName+"` must be linked to a graph variable");if(null!==this[Fr].variableBlock&&this[Fr].variableBlock!==this)throw this.blockGraph.removeBlock(this),new Error("`"+this[Fr].fancyName+"` cannot redefine variableBlock");this[Fr].variableBlock=this}},{key:"removed",value:function(){this[Fr].variableBlock=null}}]),e}(Dr),Wr=Symbol("variableName"),qr=Symbol("variableValueType"),Hr=Symbol("variableValue"),Jr=Symbol("variableBlock"),Kr=Symbol("variableGraph"),Qr=function(t){function e(t){ve.classCallCheck(this,e);var n=ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return n[Wr]=null,n[qr]=null,n[Hr]=null,n[Jr]=null,n[Kr]=null,n.create(t),n}return ve.inherits(e,t),ve.createClass(e,[{key:"create",value:function(t){if(this[Wr]=Ir(t.variableName),this[qr]=Ir(t.variableValueType),this[Hr]=Ir(t.variableValue),this[Jr]=Ir(t.variableBlock,null),!T(this[Wr]))throw new Error("`"+this.fancyName+"` `variableName` must be a non-null String");if(!T(this[qr]))throw new Error("`"+this.fancyName+"` `_variableValueType` must be a non-null String");if(null!==this[Jr]&&!(this[Jr]instanceof zr))throw new Error("`"+this.fancyName+"` `variableBlock` must be of type `VariableBlock`")}},{key:"added",value:function(){}},{key:"removed",value:function(){}},{key:"changeVariableValue",value:function(t,e){var n=this[Kr].convertValue(this[qr],t);if("undefined"==typeof n)throw new Error("`"+this.fancyName+"` "+t+"` is not compatible with type `"+this[qr]+"`");var o=this[Hr];this[Hr]=n,e||(this.emit("value-change",n,o),this[Kr].emit("variable-value-change",this,n,o))}},{key:"fancyName",get:function(){return this.toString()}},{key:"variableName",get:function(){return this[Wr]}},{key:"variableValueType",get:function(){return this[qr]}},{key:"variableValue",get:function(){return this[Hr]},set:function(t){this.changeVariableValue(t)}},{key:"variableBlock",get:function(){return this[Jr]},set:function(t){this[Jr]=t}},{key:"variableGraph",get:function(){return this[Kr]},set:function(t){this[Kr]=t}}]),e}(pr),Xr=Symbol("pointOutput"),Yr=Symbol("pointName"),Zr=Symbol("pointTemplate"),ti=Symbol("pointValueType"),ei=Symbol("pointValue"),ni=Symbol("pointPolicy"),oi=Symbol("pointBlock"),ri=Symbol("pointConnections"),ii=function(t){function e(t,n){ve.classCallCheck(this,e);var o=ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return o[Xr]=t,o[Yr]=null,o[Zr]=null,o[ti]=null,o[ei]=null,o[ni]=Cr.NONE,o[oi]=null,o[ri]=[],o.create(n),o}return ve.inherits(e,t),ve.createClass(e,[{key:"create",value:function(t){if(this[Yr]=Ir(t.pointName,null),this[Zr]=Ir(t.pointTemplate,null),this[ti]=Ir(t.pointValueType,null),this[ei]=Ir(t.pointValue,null),"undefined"!=typeof t.pointPolicy?this[ni]=Cr.deserialize(t.pointPolicy):this[ni]=Cr.DEFAULT,!T(this[Yr]))throw new Error("`"+this.fancyName+"` must have a non-null `pointName`");if(null===this[Zr]&&!T(this[ti]))throw new Error("`"+this.fancyName+"` `pointValueType` must be a non-null String if no `pointTemplate` is provided");if(this.hasPolicy(Cr.SINGLE_CONNECTION)&&this.hasPolicy(Cr.MULTIPLE_CONNECTIONS))throw new Error("`"+this.fancyName+"` `pointPolicy` cannot mix `SINGLE_CONNECTION` and `MULTIPLE_CONNECTIONS`")}},{key:"hasPolicy",value:function(t){return Cr.has(this[ni],t)}},{key:"added",value:function(){}},{key:"accept",value:function(){}},{key:"removed",value:function(){}},{key:"changeValue",value:function(t,e){if(null===this[oi])throw new Error("`"+this.fancyName+"` cannot change value when not bound to a block");if(null!==t&&!this.emptyConnection())throw new Error("`"+this.fancyName+"` cannot change value when connected to another point");if(null!==t&&!this.hasPolicy(Cr.VALUE))throw new Error("`"+this.fancyName+"` cannot change value when the policy `VALUE` is disabled");var n=this[ei],o=this[oi].blockGraph.convertValue(this[ti],t);if("undefined"==typeof o)throw new Error("`"+this[oi].blockGraph.fancyName+"` "+t+"` is not compatible with type `"+this[ti]+"`");this[ei]=o,e||(this.emit("value-change",o,n),this[oi].blockGraph.emit("point-value-change",this,o,n),this[oi].pointValueChanged(this,o,n))}},{key:"changeValueType",value:function(t,e){if(null===this[oi])throw new Error("`"+this.fancyName+"` cannot change value type when not bound to a block");if(null===this[oi].blockGraph.valueTypeByName(t))throw new Error("`"+this[oi].blockGraph.fancyName+"` has no value type `"+t+"`");if("undefined"==typeof this[oi].blockGraph.convertValue(t,this[ei]))throw new Error("`"+this[ei]+"` is not compatible with value type `"+t+"`");var n=this[ti];this[ti]=t,e||(this.emit("value-type-change",t,n),this[oi].blockGraph.emit("point-value-type-change",this,t,n)),this.changeValue(this[ei],!!e)}},{key:"empty",value:function(){return this.emptyValue()&&this.emptyConnection()}},{key:"emptyValue",value:function(){return null===this[ei]}},{key:"emptyConnection",value:function(){return 0===this[ri].length}},{key:"connect",value:function(t){if(null===this[oi])throw new Error("`"+this.fancyName+"`");return this[Xr]?this[oi].blockGraph.connect(this,t):this[oi].blockGraph.connect(t,this)}},{key:"disconnect",value:function(t){if(null===this[oi])throw new Error("`"+this.fancyName+"`");return this[Xr]?this[oi].blockGraph.disconnect(this,t):this[oi].blockGraph.disconnect(t,this)}},{key:"disconnectAll",value:function(){var t=this;ye(this[ri],function(e){t.disconnect(e.other(t))})}},{key:"connected",value:function(){}},{key:"acceptConnect",value:function(){return!0}},{key:"fancyName",get:function(){return this[Yr]}},{key:"pointType",get:function(){return this.constructor.name}},{key:"pointName",get:function(){return this[Yr]}},{key:"pointOutput",get:function(){return this[Xr]}},{key:"pointTemplate",get:function(){return this[Zr]}},{key:"pointValueType",get:function(){return this[ti]},set:function(t){this.changeValueType(t)}},{key:"pointValue",get:function(){return this[ei]},set:function(t){this.changeValue(t)}},{key:"pointPolicy",get:function(){return this[ni]}},{key:"pointBlock",get:function(){return this[oi]},set:function(t){this[oi]=t}},{key:"pointConnections",get:function(){return this[ri]}}]),e}(pr),ai=function(t){function e(){return ve.classCallCheck(this,e),ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).apply(this,arguments))}return ve.inherits(e,t),e}(ii),ui=function(t){function e(){return ve.classCallCheck(this,e),ve.possibleConstructorReturn(this,Object.getPrototypeOf(e).apply(this,arguments))}return ve.inherits(e,t),ve.createClass(e,[{key:"validatePoints",value:function(){if(!(this.inputByName("in")instanceof ai))throw new Error("`"+this.fancyName+"` must have an input `in` of type `Stream`");if(!(this.inputByName("variable")instanceof ii))throw new Error("`"+this.fancyName+"` must have an input `variable` of type `Point`");if(!(this.inputByName("value")instanceof ii))throw new Error("`"+this.fancyName+"` must have an input `value` of type `Point`");if(this.inputByName("variable").pointValueType!==this.inputByName("value").pointValueType)throw new Error("`"+this.fancyName+"` inputs `variable` and `value` must have the same pointValueType");if(!(this.outputByName("out")instanceof ai))throw new Error("`"+this.fancyName+"` must have an output `out` of type `Stream`")}}]),e}(Dr);t.Graph=Pr,t.Variable=Qr,t.Block=Dr,t.Point=ii,t.PointPolicy=Cr,t.Connection=_r,t.VariableBlock=zr,t.AssignationBlock=ui,t.StreamPoint=ai});
//# sourceMappingURL=dude-graph.js.map
